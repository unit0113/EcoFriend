"use strict";exports.id=5991,exports.ids=[5991],exports.modules={75991:(e,s,t)=>{t.r(s),t.d(s,{default:()=>ChangeUsernameSidebar});var a=t(57087),i=t(73867),n=t(76937),l=t(45232),r=t(36960),o=t.n(r);let getUserName=async(e,s)=>{let t=await fetch("/api/getUserData",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e}),cache:"no-store"}),a=await t.json();s(a.user.username)};function ChangeUsernameSidebar(){let e=(0,n.useRouter)(),{data:s}=(0,l.useSession)();(0,i.useEffect)(()=>{s&&s.user&&s.user.email||e.push("/")},[]);let t=s?.user?.email,[r,d]=(0,i.useState)("");(0,i.useEffect)(()=>{let getName=async()=>{await getUserName(t,d)};getName()});let[c,m]=(0,i.useState)(""),[u,f]=(0,i.useState)(!1),[h,g]=(0,i.useState)(!0),handleSubmit=async s=>{if(s.preventDefault(),""===c){g(!1);return}try{let s=await fetch("/api/changeUsername",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,newUsername:c})});s&&e.push("/profile")}catch(e){console.log("Error during username update: ",e)}};return(0,a.jsxs)("div",{className:"flex min-h-screen flex-col",children:[a.jsx("header",{className:"sticky top-0 flex h-16 items-center justify-center text-2xl font-bold",children:"Change Username"}),(0,a.jsxs)("h2",{className:"mt-8 text-lg font-bold leading-9 tracking-tight text-gray-900",children:["Current Username: ",r]}),a.jsx("div",{className:"flex flex-1 flex-col md:flex-row",children:a.jsx("aside",{className:"w-full",children:(0,a.jsxs)("form",{onSubmit:handleSubmit,action:"#",method:"POST",className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"username",className:"block text-sm font-medium leading-6 text-gray-900",children:"New Username"}),a.jsx("div",{className:"mt-2",children:a.jsx("input",{onChange:e=>{m(e.target.value),f(!1),g(!0)},id:"username",name:"username",type:"username",className:"block w-full rounded-md border-0 py-1.5 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})}),u&&a.jsx("div",{className:"mt-2 text-sm leading-6 text-red-500",children:"Username already taken"}),!h&&a.jsx("div",{className:"mt-2 text-sm leading-6 text-red-500",children:"Please provide a new username"})]}),a.jsx("div",{children:a.jsx("button",{type:"submit",className:"focus-visible:outline-grey-600 flex w-full justify-center rounded-md bg-gray-900 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-gray-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:"Update Username"})}),a.jsx("button",{className:"focus-visible:outline-grey-600 flex w-full justify-center rounded-md bg-gray-900 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-gray-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:a.jsx(o(),{href:"/profile",children:"Cancel"})})]})})})]})}}};